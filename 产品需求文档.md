# 视频审核管理系统 - 产品需求文档

## 1. 项目概述

### 1.1 项目背景
本系统旨在将传统的离线视频生产审核流程线上化，提升视频生产审核效率。系统主要服务于广告视频的生产制作场景，支持视频生产、标注审核、UED审核、加艺术字等完整工作流程。

### 1.2 项目目标
- 将Excel表格管理的离线审核流程转为线上系统
- 实现视频审核工作流的标准化和自动化
- 提升审核效率，减少人工操作错误
- 建立完整的审核记录和追溯体系

### 1.3 目标用户
- **标注审核员**：负责视频内容的标注审核
- **UED审核员**：负责视频的UED审核
- **加艺术字人员**：负责为视频添加艺术字
- **项目管理员**：负责整体流程管理和监控

### 1.4 系统架构
- **前端技术**：HTML5 + CSS3 + JavaScript + Bootstrap 5
- **后端技术**：Python Flask + SQLite3
- **部署方式**：本地部署，支持单机运行
- **数据存储**：SQLite数据库 + 本地文件系统

## 2. 功能需求

### 2.1 核心功能模块

#### 2.1.1 视频管理
- **视频信息展示**：显示视频的基本信息，包括视频选品日期、视频提供日期、商品ID、商品链接等
- **视频分类**：支持按品类（一级/二级/三级）、品牌、商品ID等维度分类
- **视频状态管理**：跟踪视频在不同审核阶段的状态

#### 2.1.2 审核工作流
- **标注审核**：视频生产完成后进入标注审核阶段
- **加艺术字**：标注审核通过后，支持上传加艺术字视频
- **UED审核**：加艺术字视频上传后进入UED审核阶段
- **状态流转**：自动跟踪和更新视频在各阶段的状态

#### 2.1.3 审核功能
- **视频播放**：支持在线播放原始生产视频和加艺术字视频
- **截图功能**：审核过程中可截取视频帧作为审核依据
- **审核意见**：支持填写详细的审核意见和问题描述
- **审核结果**：支持通过/不通过的审核结果记录

#### 2.1.4 人员管理
- **审核员分配**：支持为视频分配标注审核员和UED审核员
- **加艺术字人员**：支持分配加艺术字人员
- **批量操作**：支持批量分配审核员和批量下载视频

### 2.2 辅助功能模块

#### 2.2.1 筛选和搜索
- **多维度筛选**：支持按视频提供日期、品牌、商品ID、审核状态、完成情况等筛选
- **实时搜索**：支持实时搜索和筛选结果更新
- **筛选重置**：支持一键重置所有筛选条件

#### 2.2.2 数据展示
- **列表展示**：以表格形式展示视频列表，支持自定义列显示
- **状态指示**：直观显示视频当前所处的审核阶段
- **缩略图展示**：审核截图以缩略图形式展示，支持点击放大

#### 2.2.3 文件管理
- **视频上传**：支持上传加艺术字视频
- **文件预览**：支持视频文件预览和播放
- **批量下载**：支持批量下载原始生产视频

## 3. 详细功能设计

### 3.1 筛选功能详细设计

#### 3.1.1 筛选条件
系统提供以下筛选条件，所有筛选条件在同一行显示：

1. **完成状态筛选**
   - 选项：全部状态、未上传、已上传
   - 功能：筛选视频的完成状态

2. **当前阶段筛选**
   - 选项：全部阶段、视频生产、标注审核、UED审核、加艺术字、已完成
   - 功能：筛选视频当前所处的审核阶段

3. **审核员筛选**
   - 选项：全部审核员、王嘉欣、王量、豆玉欣
   - 功能：筛选分配给特定审核员的视频

4. **品牌名称筛选**
   - 选项：全部品牌、芙丽芳丝、安踏、增致牛仔、富铤、雪中飞、秋水伊人
   - 功能：按品牌筛选视频

5. **视频提供日期筛选**
   - 类型：日期选择器
   - 功能：筛选特定日期提供的视频

6. **商品ID筛选**
   - 类型：文本输入框
   - 功能：精确搜索特定商品ID的视频

7. **标注验收状态筛选**
   - 选项：全部状态、可用、不可用、未审核
   - 功能：筛选标注审核状态

8. **UED验收状态筛选**
   - 选项：全部状态、可用、不可用、未审核
   - 功能：筛选UED审核状态

#### 3.1.2 筛选操作
- **查询按钮**：应用所有筛选条件，重新加载数据
- **重置按钮**：清空所有筛选条件，恢复默认显示
- **实时筛选**：筛选条件变更后自动触发查询

### 3.2 任务列表详细设计

#### 3.2.1 列表布局
- **表格形式**：采用Bootstrap表格组件
- **横向滚动**：支持水平滚动查看完整信息
- **响应式设计**：适配不同屏幕尺寸

#### 3.2.2 列显示配置
系统支持自定义列显示，包含以下可选列：

**必需列（不可隐藏）：**
- 勾选框：用于批量选择操作
- 素材信息：显示素材名称和基本信息
- 原始生产视频：显示原始视频播放按钮
- 加艺术字视频：显示加艺术字视频状态
- 当前阶段：显示视频当前审核阶段

**可选列：**
- 选品日期：视频选品日期
- 提供日期：视频提供日期
- 商品信息：商品ID和商品链接
- 审核员：分配的标注审核员
- 标注验收状态：标注审核状态选择器
- 加艺术字人员：分配的加艺术字人员
- UED验收状态：UED审核状态选择器
- 标注审核意见：标注审核意见内容
- 标注审核截图：标注审核截图缩略图
- UED审核意见：UED审核意见内容
- UED审核截图：UED审核截图缩略图
- 品牌：品牌信息
- 品类信息：商品分类信息
- 售价：商品售价
- 卖点：商品卖点信息
- 生产详情：生产流程详情

#### 3.2.3 列设置功能
- **列设置按钮**：打开列设置模态框
- **拖拽排序**：支持列顺序调整
- **全选/全不选**：批量选择或取消选择列
- **恢复默认**：恢复默认列配置
- **设置保存**：将列配置保存到本地存储

### 3.3 交互流程详细设计

#### 3.3.1 审核员分配流程
1. **选择视频**：在任务列表中勾选需要分配的视频
2. **批量分配**：点击"批量分配审核员"按钮
3. **选择审核员**：从下拉列表中选择审核员（王嘉欣、王量、豆玉欣）
4. **确认分配**：系统更新数据库，刷新列表显示

#### 3.3.2 标注审核流程
1. **进入审核**：点击原始视频的眼睛图标
2. **视频播放**：左侧播放原始生产视频
3. **审核操作**：
   - 查看审核员信息（只读显示）
   - 选择审核结果（可用/不可用）
   - 填写审核意见
   - 截取问题画面（点击"截帧"按钮）
4. **提交审核**：点击"提交审核"按钮
5. **状态更新**：系统更新审核状态，返回任务列表

#### 3.3.3 加艺术字流程
1. **状态检查**：确认视频处于"待加艺术字"状态
2. **上传视频**：点击"上传视频"按钮
3. **文件选择**：选择加艺术字后的视频文件
4. **文件预览**：预览上传的视频文件
5. **确认上传**：点击"确认上传"按钮
6. **状态更新**：系统更新视频状态为"待UED审核"

#### 3.3.4 UED审核流程
1. **进入审核**：点击加艺术字视频的眼睛图标
2. **视频播放**：左侧播放加艺术字视频
3. **审核操作**：
   - 选择审核结果（可用/不可用）
   - 填写审核意见
   - 截取问题画面
4. **提交审核**：点击"提交审核"按钮
5. **流程完成**：审核通过后流程结束

### 3.4 状态管理详细设计

#### 3.4.1 状态定义
系统定义以下审核状态：

1. **待标注审核**
   - 条件：标注审核状态为"未审核"或null
   - 显示：时钟图标 + "待标注审核"文字
   - 可执行操作：分配审核员、播放原始视频、标注审核

2. **标注审核不通过**
   - 条件：标注审核状态为"不可用"
   - 显示：叉号图标 + "标注审核不通过"文字
   - 可执行操作：查看审核意见和截图

3. **待加艺术字**
   - 条件：标注审核状态为"可用"且未上传加艺术字视频
   - 显示：画笔图标 + "待加艺术字"文字
   - 可执行操作：上传加艺术字视频

4. **待UED审核**
   - 条件：标注审核通过且已上传加艺术字视频，UED未审核
   - 显示：搜索图标 + "待UED审核"文字
   - 可执行操作：分配UED审核员、播放加艺术字视频、UED审核

5. **UED审核通过**
   - 条件：UED审核状态为"可用"
   - 显示：对勾图标 + "UED审核通过"文字
   - 可执行操作：查看最终结果

6. **UED审核不通过**
   - 条件：UED审核状态为"不可用"
   - 显示：叉号图标 + "UED审核不通过"文字
   - 可执行操作：查看审核意见和截图

#### 3.4.2 状态流转规则
- 视频生产完成 → 待标注审核
- 标注审核通过 → 待加艺术字
- 加艺术字完成 → 待UED审核
- UED审核通过 → UED审核通过
- 任何阶段审核不通过 → 对应不通过状态

### 3.5 文件管理详细设计

#### 3.5.1 视频播放功能
- **播放器**：使用HTML5 video标签
- **播放控制**：支持播放、暂停、进度条控制
- **全屏播放**：支持全屏模式播放
- **跨域处理**：设置crossOrigin属性处理跨域视频

#### 3.5.2 截图功能
- **截图方式**：使用Canvas API截取视频当前帧
- **截图格式**：PNG格式，base64编码
- **截图存储**：保存到screenshots目录，记录到数据库
- **截图显示**：缩略图形式显示，支持点击放大
- **截图管理**：支持删除截图操作

#### 3.5.3 文件上传功能
- **上传限制**：最大500MB文件大小
- **文件类型**：支持MP4等视频格式
- **上传进度**：显示上传进度条
- **文件验证**：上传前验证文件格式和大小
- **存储路径**：保存到uploads目录

#### 3.5.4 批量下载功能
- **选择方式**：勾选多个视频进行批量下载
- **下载策略**：逐个下载，避免浏览器阻塞
- **下载延迟**：每个文件下载间隔500ms
- **文件命名**：使用原始文件名进行下载

### 3.6 数据统计详细设计

#### 3.6.1 统计指标
- **总视频数**：系统中所有视频的总数量
- **待标注审核**：等待标注审核的视频数量
- **待加艺术字**：等待加艺术字的视频数量
- **待UED审核**：等待UED审核的视频数量
- **已完成**：审核完成的视频数量
- **审核不通过**：审核不通过的视频数量

#### 3.6.2 统计显示
- **卡片式布局**：每个统计指标独立卡片显示
- **实时更新**：统计数据实时更新
- **颜色区分**：不同状态使用不同颜色标识

## 4. 业务流程

### 4.1 标准审核流程

```
1. 视频生产完成
   ↓
2. 视频进入"待标注审核"状态
   ↓
3. 分配标注审核员
   ↓
4. 标注审核员审核视频
   - 播放原始视频
   - 截取问题画面
   - 填写审核意见
   - 提交审核结果（通过/不通过）
   ↓
5. 审核通过 → 进入"待加艺术字"状态
   审核不通过 → 流程结束
   ↓
6. 上传加艺术字视频
   ↓
7. 进入"待UED审核"状态
   ↓
8. 分配UED审核员
   ↓
9. UED审核员审核加艺术字视频
   - 播放加艺术字视频
   - 截取问题画面
   - 填写审核意见
   - 提交审核结果（通过/不通过）
   ↓
10. 审核通过 → "UED审核通过"
    审核不通过 → "UED审核不通过"
```

### 4.2 状态定义

| 状态 | 描述 | 可执行操作 |
|------|------|------------|
| 待标注审核 | 视频生产完成，等待标注审核 | 分配审核员、播放原始视频、标注审核 |
| 标注审核不通过 | 标注审核未通过 | 查看审核意见和截图 |
| 待加艺术字 | 标注审核通过，等待加艺术字 | 上传加艺术字视频 |
| 待UED审核 | 加艺术字完成，等待UED审核 | 分配UED审核员、播放加艺术字视频、UED审核 |
| UED审核通过 | UED审核通过，流程完成 | 查看最终结果 |
| UED审核不通过 | UED审核未通过 | 查看审核意见和截图 |

## 5. 界面需求

### 5.1 主界面布局
- **顶部筛选区**：包含所有筛选条件，单行布局
- **操作按钮区**：包含列设置、批量下载等功能按钮
- **数据表格区**：展示视频列表，支持横向滚动
- **分页区**：支持分页显示大量数据

### 5.2 审核页面
- **左侧视频播放区**：播放待审核的视频
- **右侧审核操作区**：包含审核员信息、审核结果选择、审核意见输入
- **截图展示区**：显示截取的视频帧，支持删除操作

### 5.3 响应式设计
- 支持不同屏幕尺寸的自适应显示
- 移动端友好的操作界面
- 合理的字体大小和间距设计

## 6. 数据需求

### 6.1 视频基础数据
- 视频ID、视频名称、视频URL
- 商品信息：商品ID、商品链接、商品分类
- 时间信息：视频选品日期、视频提供日期
- 品牌信息：品牌名称、品类信息

### 6.2 审核数据
- 审核记录：审核员、审核时间、审核结果、审核意见
- 截图数据：截图文件路径、截图时间、关联的审核记录
- 工作流状态：当前阶段、完成状态、相关人员分配

### 6.3 用户数据
- 审核员信息：姓名、角色、分配状态
- 操作日志：操作时间、操作类型、操作结果

## 7. 性能需求

### 7.1 响应时间
- 页面加载时间：< 3秒
- 视频播放启动时间：< 5秒
- 审核操作响应时间：< 2秒

### 7.2 并发处理
- 支持多用户同时在线操作
- 支持并发审核和文件上传
- 数据库操作响应时间：< 1秒

### 7.3 存储需求
- 视频文件存储：支持大文件上传和存储
- 截图文件存储：支持批量截图存储
- 数据库存储：支持大量审核记录存储

## 8. 安全需求

### 8.1 数据安全
- 视频文件访问控制
- 审核数据权限控制
- 敏感信息保护

### 8.2 操作安全
- 审核操作日志记录
- 数据修改权限控制
- 文件上传安全检查

## 9. 兼容性需求

### 9.1 浏览器兼容
- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

### 9.2 设备兼容
- 桌面端：1920x1080及以上分辨率
- 平板端：1024x768及以上分辨率
- 移动端：375x667及以上分辨率

## 10. 扩展性需求

### 10.1 功能扩展
- 支持更多审核类型
- 支持自定义审核流程
- 支持更多文件格式

### 10.2 性能扩展
- 支持分布式部署
- 支持负载均衡
- 支持数据库集群

## 11. 验收标准

### 11.1 功能验收
- 所有核心功能正常运行
- 审核流程完整无误
- 数据准确性验证通过

### 11.2 性能验收
- 响应时间满足要求
- 并发处理能力达标
- 系统稳定性验证

### 11.3 用户体验验收
- 界面友好易用
- 操作流程顺畅
- 错误处理完善