<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>视频审核管理系统 - 演示版</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .main-container {
            max-width: 100%;
            margin: 0;
            padding: 0;
        }
        
        .filter-panel {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .content-panel {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .stats-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .stats-card h3 {
            color: #1f2937;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .stats-card p {
            color: #6b7280;
            font-size: 14px;
            margin: 0;
        }
        
        .form-control, .form-select {
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 8px 12px;
            font-size: 14px;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .btn {
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 16px;
        }
        
        .btn-primary {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }
        
        .btn-primary:hover {
            background-color: #2563eb;
            border-color: #2563eb;
        }
        
        .btn-outline-primary {
            color: #3b82f6;
            border-color: #3b82f6;
        }
        
        .btn-outline-primary:hover {
            background-color: #3b82f6;
            border-color: #3b82f6;
        }
        
        .btn-secondary {
            background-color: #6b7280;
            border-color: #6b7280;
        }
        
        .btn-secondary:hover {
            background-color: #4b5563;
            border-color: #4b5563;
        }
        
        .btn-success {
            background-color: #10b981;
            border-color: #10b981;
        }
        
        .btn-success:hover {
            background-color: #059669;
            border-color: #059669;
        }
        
        .btn-danger {
            background-color: #ef4444;
            border-color: #ef4444;
        }
        
        .btn-danger:hover {
            background-color: #dc2626;
            border-color: #dc2626;
        }
        
        .btn-warning {
            background-color: #f59e0b;
            border-color: #f59e0b;
        }
        
        .btn-warning:hover {
            background-color: #d97706;
            border-color: #d97706;
        }
        
        .btn-sm {
            padding: 4px 8px;
            font-size: 12px;
        }
        
        .table {
            margin-bottom: 0;
        }
        
        .table th {
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
            padding: 12px 8px;
        }
        
        .table td {
            padding: 12px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #e5e7eb;
            font-size: 14px;
        }
        
        .table-responsive {
            border-radius: 8px;
            overflow: hidden;
        }
        
        .badge {
            font-size: 12px;
            font-weight: 500;
            padding: 4px 8px;
        }
        
        .badge.bg-success {
            background-color: #10b981 !important;
        }
        
        .badge.bg-warning {
            background-color: #f59e0b !important;
        }
        
        .badge.bg-danger {
            background-color: #ef4444 !important;
        }
        
        .badge.bg-secondary {
            background-color: #6b7280 !important;
        }
        
        .badge.bg-info {
            background-color: #3b82f6 !important;
        }
        
        .badge.bg-primary {
            background-color: #8b5cf6 !important;
        }
        
        .dropdown-toggle::after {
            margin-left: 0.5em;
        }
        
        .dropdown-menu {
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .dropdown-item {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .dropdown-item:hover {
            background-color: #f8f9fa;
        }
        
        .modal-content {
            border: none;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .modal-header {
            border-bottom: 1px solid #e5e7eb;
            padding: 20px 24px;
        }
        
        .modal-body {
            padding: 24px;
        }
        
        .modal-footer {
            border-top: 1px solid #e5e7eb;
            padding: 20px 24px;
        }
        
        .form-label {
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
        }
        
        .alert {
            border: none;
            border-radius: 8px;
            padding: 12px 16px;
        }
        
        .alert-success {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .alert-danger {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        .alert-warning {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .alert-info {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .video-player {
            width: 100%;
            max-width: 100%;
            border-radius: 8px;
        }
        
        .screenshot-thumbnail {
            width: 60px;
            height: 40px;
            object-fit: cover;
            border-radius: 4px;
            cursor: pointer;
            border: 2px solid #e5e7eb;
        }
        
        .screenshot-thumbnail:hover {
            border-color: #3b82f6;
        }
        
        .stage-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }
        
        .stage-item {
            padding: 4px 8px;
            border-radius: 4px;
            background-color: #f3f4f6;
            color: #6b7280;
        }
        
        .stage-item.active {
            background-color: #3b82f6;
            color: white;
        }
        
        .stage-item.completed {
            background-color: #10b981;
            color: white;
        }
        
        .stage-item.rejected {
            background-color: #ef4444;
            color: white;
        }
        
        .stage-arrow {
            color: #9ca3af;
        }
        
        .eye-icon {
            color: #3b82f6;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        .eye-icon:hover {
            background-color: #dbeafe;
            transform: scale(1.1);
        }
        
        .upload-btn {
            background-color: #10b981;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }
        
        .upload-btn:hover {
            background-color: #059669;
        }
        
        .checkbox-column {
            width: 40px;
            text-align: center;
        }
        
        .material-info {
            font-size: 12px;
            color: #6b7280;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .material-info:hover {
            overflow: visible;
            white-space: normal;
            background-color: #f8f9fa;
            padding: 4px;
            border-radius: 4px;
            position: absolute;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        
        .category-info {
            font-size: 12px;
            color: #6b7280;
        }
        
        .brand-info {
            font-size: 12px;
            color: #6b7280;
        }
        
        .product-link {
            color: #3b82f6;
            text-decoration: none;
            font-size: 12px;
        }
        
        .product-link:hover {
            text-decoration: underline;
        }
        
        .filter-row {
            display: flex;
            gap: 12px;
            align-items: end;
            flex-wrap: wrap;
        }
        
        .filter-item {
            flex: 1;
            min-width: 120px;
        }
        
        .filter-item.wide {
            flex: 2;
            min-width: 200px;
        }
        
        .filter-item.narrow {
            flex: 0.5;
            min-width: 80px;
        }
        
        .column-settings-btn {
            background-color: #6b7280;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
        }
        
        .column-settings-btn:hover {
            background-color: #4b5563;
        }
        
        .demo-notice {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .demo-notice i {
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- 演示提示 -->
        <div class="container-fluid">
            <div class="demo-notice">
                <i class="fas fa-info-circle"></i>
                <strong>演示模式</strong> - 这是静态演示版本，展示系统界面和功能。完整功能需要本地部署Flask应用。
            </div>
        </div>

        <!-- 统计卡片 -->
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-2">
                    <div class="stats-card">
                        <h3 id="totalVideos">156</h3>
                        <p>总视频数</p>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="stats-card">
                        <h3 id="annotationPending">23</h3>
                        <p>待标注审核</p>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="stats-card">
                        <h3 id="artworkPending">45</h3>
                        <p>待加艺术字</p>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="stats-card">
                        <h3 id="uedPending">67</h3>
                        <p>待UED审核</p>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="stats-card">
                        <h3 id="completedVideos">21</h3>
                        <p>已完成</p>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="stats-card">
                        <h3 id="pendingVideos">0</h3>
                        <p>审核不通过</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 筛选面板 -->
        <div class="container-fluid">
            <div class="filter-panel">
                <div class="filter-row">
                    <div class="filter-item narrow">
                        <label class="form-label">完成状态</label>
                        <select class="form-select" id="statusFilter">
                            <option value="">全部</option>
                            <option value="completed">已完成</option>
                            <option value="in_progress">进行中</option>
                            <option value="pending">待处理</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="form-label">当前阶段</label>
                        <select class="form-select" id="stageFilter">
                            <option value="">全部</option>
                            <option value="annotation_review">待标注审核</option>
                            <option value="artwork">待加艺术字</option>
                            <option value="ued_review">待UED审核</option>
                            <option value="completed">已完成</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="form-label">审核员</label>
                        <select class="form-select" id="reviewerFilter">
                            <option value="">全部</option>
                            <option value="王嘉欣">王嘉欣</option>
                            <option value="王量">王量</option>
                            <option value="豆玉欣">豆玉欣</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="form-label">品牌名称</label>
                        <select class="form-select" id="brandFilter">
                            <option value="">全部</option>
                            <option value="富铤">富铤</option>
                            <option value="VIP自营">VIP自营</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="form-label">视频提供日期</label>
                        <input type="date" class="form-control" id="provideDateFilter">
                    </div>
                    <div class="filter-item narrow">
                        <label class="form-label">商品ID</label>
                        <input type="text" class="form-control" id="productIdFilter" placeholder="输入商品ID">
                    </div>
                    <div class="filter-item">
                        <label class="form-label">标注验收状态</label>
                        <select class="form-select" id="annotationStatusFilter">
                            <option value="">全部</option>
                            <option value="未审核">未审核</option>
                            <option value="可用">可用</option>
                            <option value="不可用">不可用</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="form-label">UED验收状态</label>
                        <select class="form-select" id="uedStatusFilter">
                            <option value="">全部</option>
                            <option value="未审核">未审核</option>
                            <option value="可用">可用</option>
                            <option value="不可用">不可用</option>
                        </select>
                    </div>
                    <div class="filter-item narrow">
                        <button class="btn btn-primary" onclick="applyFilters()">查询</button>
                        <button class="btn btn-secondary" onclick="resetFilters()">重置</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 内容面板 -->
        <div class="container-fluid">
            <div class="content-panel">
                <div class="d-flex justify-content-between align-items-center p-3 border-bottom">
                    <h5 class="mb-0">视频任务列表</h5>
                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-primary btn-sm" onclick="selectAll()">
                            <i class="fas fa-check-square me-1"></i>全选
                        </button>
                        <button class="btn btn-outline-secondary btn-sm" onclick="batchAssign()">
                            <i class="fas fa-users me-1"></i>批量分配
                        </button>
                        <button class="btn btn-outline-success btn-sm" onclick="batchDownload()">
                            <i class="fas fa-download me-1"></i>批量下载
                        </button>
                        <button class="column-settings-btn" onclick="showColumnSettings()">
                            <i class="fas fa-cog me-1"></i>列设置
                        </button>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th class="checkbox-column">
                                    <input type="checkbox" id="selectAllCheckbox" onchange="toggleSelectAll()">
                                </th>
                                <th>素材信息</th>
                                <th>审核员</th>
                                <th>标注验收状态</th>
                                <th>加艺术字人员</th>
                                <th>UED验收状态</th>
                                <th>当前阶段</th>
                                <th>品类</th>
                                <th>品牌信息</th>
                                <th>视频选品日期</th>
                                <th>视频提供日期</th>
                                <th>商品信息</th>
                                <th>原始生产视频</th>
                                <th>加艺术字视频</th>
                                <th>标注审核意见</th>
                                <th>标注审核截图</th>
                                <th>UED审核意见</th>
                                <th>UED审核截图</th>
                                <th>生产详情</th>
                            </tr>
                        </thead>
                        <tbody id="videosTableBody">
                            <!-- 视频数据将通过JavaScript动态加载 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 审核模态框 -->
    <div class="modal fade" id="reviewModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">视频审核</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="mb-3">
                                <video class="video-player" controls id="reviewVideo">
                                    <source src="https://vos.vipstatic.com/mre-admin.vip.vip.com/cv-ued-wp-video/2025_10_21_09_26_34_164495-40939.mp4" type="video/mp4">
                                    您的浏览器不支持视频播放。
                                </video>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-warning" onclick="captureFrame()">
                                    <i class="fas fa-camera me-1"></i>截帧
                                </button>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">审核员</label>
                                <input type="text" class="form-control" id="reviewerName" readonly>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">审核结果</label>
                                <select class="form-select" id="reviewStatusSelect">
                                    <option value="可用">可用</option>
                                    <option value="不可用">不可用</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">审核意见</label>
                                <textarea class="form-control" rows="4" id="problemDescription" placeholder="请输入审核意见..."></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">截图</label>
                                <div id="screenshotsContainer">
                                    <!-- 截图将在这里显示 -->
                                </div>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-primary" onclick="submitReview()">提交审核</button>
                                <button class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 上传模态框 -->
    <div class="modal fade" id="uploadModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">上传加艺术字视频</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">选择视频文件</label>
                        <input type="file" class="form-control" id="videoFile" accept="video/*">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">视频预览</label>
                        <video id="videoPreview" class="video-player" style="display: none;" controls>
                            请选择视频文件
                        </video>
                    </div>
                    <div class="d-flex gap-2">
                        <button class="btn btn-primary" onclick="uploadVideo()">上传</button>
                        <button class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 生产详情模态框 -->
    <div class="modal fade" id="productionModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">生产详情</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <pre id="productionDetails" style="background-color: #f8f9fa; padding: 1rem; border-radius: 8px; font-size: 14px;">{
  "脚本内容": "展示男士衬衫的商务休闲特性，突出面料质感和版型设计",
  "分段结果": "开场3秒-产品展示，中间15秒-细节特写，结尾5秒-品牌标识",
  "卖点": "高品质面料，商务休闲两相宜，舒适透气，版型修身",
  "高亮字": "商务休闲 | 舒适透气 | 版型修身",
  "音色": "男声，沉稳专业，语速适中"
}</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- 截图查看模态框 -->
    <div class="modal fade" id="screenshotModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">截图查看</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="screenshotImage" src="" class="img-fluid" style="max-height: 70vh;">
                </div>
            </div>
        </div>
    </div>

    <!-- 列设置模态框 -->
    <div class="modal fade" id="columnSettingsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">列显示设置</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>可选列</h6>
                            <div id="availableColumns" class="border p-3" style="min-height: 300px;">
                                <!-- 可选列将在这里显示 -->
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>已选列</h6>
                            <div id="selectedColumns" class="border p-3" style="min-height: 300px;">
                                <!-- 已选列将在这里显示 -->
                            </div>
                        </div>
                    </div>
                    <div class="mt-3 d-flex gap-2">
                        <button class="btn btn-outline-primary" onclick="selectAllColumns()">全选</button>
                        <button class="btn btn-outline-secondary" onclick="deselectAllColumns()">全不选</button>
                        <button class="btn btn-outline-info" onclick="resetToDefault()">恢复默认</button>
                        <button class="btn btn-primary" onclick="saveColumnSettings()">保存设置</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 模拟数据
        const mockVideos = [
            {
                id: 'VID-001',
                material_name: 'VIP自A富男式衬0171',
                annotation_reviewer: '王嘉欣',
                annotation_status: '未审核',
                artwork_person: '王量',
                ued_status: '未审核',
                current_stage: '待标注审核',
                category: '男装/男上装/男士衬衫',
                brand: '富铤',
                selection_date: '2024-01-15',
                provide_date: '2024-01-20',
                product_id: '12345',
                product_url: 'https://example.com/product/12345',
                original_video_url: 'https://vos.vipstatic.com/mre-admin.vip.vip.com/cv-ued-wp-video/2025_10_21_09_26_34_164495-40939.mp4',
                artwork_video_url: null,
                annotation_comment: '',
                annotation_screenshots: [],
                ued_comment: '',
                ued_screenshots: []
            },
            {
                id: 'VID-002',
                material_name: 'VIP自A女装连衣裙',
                annotation_reviewer: '王量',
                annotation_status: '可用',
                artwork_person: '豆玉欣',
                ued_status: '未审核',
                current_stage: '待加艺术字',
                category: '女装/连衣裙/长袖连衣裙',
                brand: 'VIP自营',
                selection_date: '2024-01-16',
                provide_date: '2024-01-21',
                product_id: '67890',
                product_url: 'https://example.com/product/67890',
                original_video_url: 'https://vos.vipstatic.com/mre-admin.vip.vip.com/cv-ued-wp-video/2025_10_21_09_26_59_663020-70687.mp4',
                artwork_video_url: null,
                annotation_comment: '视频质量良好，符合要求',
                annotation_screenshots: ['screenshot1.jpg'],
                ued_comment: '',
                ued_screenshots: []
            },
            {
                id: 'VID-003',
                material_name: 'VIP自A运动鞋',
                annotation_reviewer: '豆玉欣',
                annotation_status: '可用',
                artwork_person: '王嘉欣',
                ued_status: '可用',
                current_stage: 'UED审核通过',
                category: '鞋靴/运动鞋/跑步鞋',
                brand: '富铤',
                selection_date: '2024-01-17',
                provide_date: '2024-01-22',
                product_id: '11111',
                product_url: 'https://example.com/product/11111',
                original_video_url: 'https://vos.vipstatic.com/mre-admin.vip.vip.com/cv-ued-wp-video/2025_10_21_09_45_57_172629-52445.mp4',
                artwork_video_url: 'https://vos.vipstatic.com/mre-admin.vip.vip.com/cv-ued-wp-video/2025_10_21_09_51_21_099689-27611.mp4',
                annotation_comment: '视频质量优秀，艺术字效果良好',
                annotation_screenshots: ['screenshot1.jpg', 'screenshot2.jpg'],
                ued_comment: '整体效果很好，符合UED标准',
                ued_screenshots: ['ued1.jpg', 'ued2.jpg']
            }
        ];

        let currentVideos = [...mockVideos];
        let currentReviewVideo = null;

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            loadVideos();
        });

        // 加载视频列表
        function loadVideos() {
            renderVideosTable(currentVideos);
        }

        // 渲染视频表格
        function renderVideosTable(videos) {
            const tbody = document.getElementById('videosTableBody');
            tbody.innerHTML = '';

            videos.forEach(video => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="checkbox-column">
                        <input type="checkbox" class="video-checkbox" value="${video.id}">
                    </td>
                    <td>
                        <div class="material-info" title="${video.material_name} - 高品质产品，精选面料，舒适透气">
                            ${video.material_name}
                        </div>
                    </td>
                    <td>
                        <select class="form-select form-select-sm" onchange="updateReviewer('${video.id}', this.value)">
                            <option value="">未分配</option>
                            <option value="王嘉欣" ${video.annotation_reviewer === '王嘉欣' ? 'selected' : ''}>王嘉欣</option>
                            <option value="王量" ${video.annotation_reviewer === '王量' ? 'selected' : ''}>王量</option>
                            <option value="豆玉欣" ${video.annotation_reviewer === '豆玉欣' ? 'selected' : ''}>豆玉欣</option>
                        </select>
                    </td>
                    <td>
                        <select class="form-select form-select-sm" onchange="updateAnnotationStatus('${video.id}', this.value)">
                            <option value="未审核" ${video.annotation_status === '未审核' ? 'selected' : ''}>未审核</option>
                            <option value="可用" ${video.annotation_status === '可用' ? 'selected' : ''}>可用</option>
                            <option value="不可用" ${video.annotation_status === '不可用' ? 'selected' : ''}>不可用</option>
                        </select>
                    </td>
                    <td>
                        <select class="form-select form-select-sm" onchange="updateArtworkPerson('${video.id}', this.value)">
                            <option value="">未分配</option>
                            <option value="王嘉欣" ${video.artwork_person === '王嘉欣' ? 'selected' : ''}>王嘉欣</option>
                            <option value="王量" ${video.artwork_person === '王量' ? 'selected' : ''}>王量</option>
                            <option value="豆玉欣" ${video.artwork_person === '豆玉欣' ? 'selected' : ''}>豆玉欣</option>
                        </select>
                    </td>
                    <td>
                        <select class="form-select form-select-sm" onchange="updateUedStatus('${video.id}', this.value)">
                            <option value="未审核" ${video.ued_status === '未审核' ? 'selected' : ''}>未审核</option>
                            <option value="可用" ${video.ued_status === '可用' ? 'selected' : ''}>可用</option>
                            <option value="不可用" ${video.ued_status === '不可用' ? 'selected' : ''}>不可用</option>
                        </select>
                    </td>
                    <td>
                        <div class="stage-indicator">
                            <span class="stage-item ${getStageClass(video.current_stage)}">${video.current_stage}</span>
                        </div>
                    </td>
                    <td>
                        <div class="category-info">${video.category}</div>
                    </td>
                    <td>
                        <div class="brand-info">${video.brand}</div>
                    </td>
                    <td>${video.selection_date}</td>
                    <td>${video.provide_date}</td>
                    <td>
                        <a href="${video.product_url}" class="product-link" target="_blank">${video.product_id}</a>
                    </td>
                    <td>
                        <i class="fas fa-eye eye-icon" onclick="openReviewModal('${video.id}', 'original')" title="播放原始视频"></i>
                    </td>
                    <td>
                        ${getArtworkVideoDisplay(video)}
                    </td>
                    <td>${video.annotation_comment || '--'}</td>
                    <td>
                        ${getScreenshotsDisplay(video.annotation_screenshots)}
                    </td>
                    <td>${video.ued_comment || '--'}</td>
                    <td>
                        ${getScreenshotsDisplay(video.ued_screenshots)}
                    </td>
                    <td>
                        <button class="btn btn-outline-info btn-sm" onclick="showProductionDetails('${video.id}')">详情</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // 获取阶段样式类
        function getStageClass(stage) {
            if (stage.includes('通过')) return 'completed';
            if (stage.includes('不通过')) return 'rejected';
            return 'active';
        }

        // 获取艺术字视频显示
        function getArtworkVideoDisplay(video) {
            if (video.annotation_status === '不可用') {
                return '--';
            } else if (video.annotation_status === '未审核') {
                return '--';
            } else if (video.artwork_video_url) {
                return `<i class="fas fa-eye eye-icon" onclick="openReviewModal('${video.id}', 'artwork')" title="播放艺术字视频"></i>`;
            } else {
                return `<button class="upload-btn" onclick="openUploadModal('${video.id}')">上传视频</button>`;
            }
        }

        // 获取截图显示
        function getScreenshotsDisplay(screenshots) {
            if (!screenshots || screenshots.length === 0) {
                return '无截图';
            }
            return screenshots.map((screenshot, index) => 
                `<img src="https://via.placeholder.com/60x40/10b981/ffffff?text=截图${index + 1}" 
                      class="screenshot-thumbnail me-1" 
                      onclick="showScreenshot('${screenshot}')">`
            ).join('');
        }

        // 筛选功能
        function applyFilters() {
            console.log('应用筛选条件');
            // 在实际应用中，这里会发送请求到后端
        }

        function resetFilters() {
            document.getElementById('statusFilter').value = '';
            document.getElementById('stageFilter').value = '';
            document.getElementById('reviewerFilter').value = '';
            document.getElementById('brandFilter').value = '';
            document.getElementById('provideDateFilter').value = '';
            document.getElementById('productIdFilter').value = '';
            document.getElementById('annotationStatusFilter').value = '';
            document.getElementById('uedStatusFilter').value = '';
        }

        // 选择功能
        function selectAll() {
            const checkboxes = document.querySelectorAll('.video-checkbox');
            checkboxes.forEach(checkbox => checkbox.checked = true);
            document.getElementById('selectAllCheckbox').checked = true;
        }

        function toggleSelectAll() {
            const selectAllCheckbox = document.getElementById('selectAllCheckbox');
            const checkboxes = document.querySelectorAll('.video-checkbox');
            checkboxes.forEach(checkbox => checkbox.checked = selectAllCheckbox.checked);
        }

        function batchAssign() {
            const selectedVideos = Array.from(document.querySelectorAll('.video-checkbox:checked')).map(cb => cb.value);
            if (selectedVideos.length === 0) {
                alert('请先选择要分配的视频');
                return;
            }
            console.log('批量分配视频:', selectedVideos);
            alert(`已选择 ${selectedVideos.length} 个视频进行批量分配`);
        }

        function batchDownload() {
            const selectedVideos = Array.from(document.querySelectorAll('.video-checkbox:checked')).map(cb => cb.value);
            if (selectedVideos.length === 0) {
                alert('请先选择要下载的视频');
                return;
            }
            console.log('批量下载视频:', selectedVideos);
            alert(`开始下载 ${selectedVideos.length} 个视频的原始文件`);
        }

        // 状态更新
        function updateReviewer(videoId, reviewer) {
            console.log(`更新视频 ${videoId} 的审核员为: ${reviewer}`);
            const video = currentVideos.find(v => v.id === videoId);
            if (video) {
                video.annotation_reviewer = reviewer;
            }
        }

        function updateAnnotationStatus(videoId, status) {
            console.log(`更新视频 ${videoId} 的标注状态为: ${status}`);
            const video = currentVideos.find(v => v.id === videoId);
            if (video) {
                video.annotation_status = status;
                // 更新当前阶段
                updateCurrentStage(video);
            }
        }

        function updateArtworkPerson(videoId, person) {
            console.log(`更新视频 ${videoId} 的加艺术字人员为: ${person}`);
            const video = currentVideos.find(v => v.id === videoId);
            if (video) {
                video.artwork_person = person;
            }
        }

        function updateUedStatus(videoId, status) {
            console.log(`更新视频 ${videoId} 的UED状态为: ${status}`);
            const video = currentVideos.find(v => v.id === videoId);
            if (video) {
                video.ued_status = status;
                // 更新当前阶段
                updateCurrentStage(video);
            }
        }

        function updateCurrentStage(video) {
            if (video.annotation_status === '未审核') {
                video.current_stage = '待标注审核';
            } else if (video.annotation_status === '不可用') {
                video.current_stage = '标注审核不通过';
            } else if (video.annotation_status === '可用' && !video.artwork_video_url) {
                video.current_stage = '待加艺术字';
            } else if (video.annotation_status === '可用' && video.artwork_video_url && video.ued_status === '未审核') {
                video.current_stage = '待UED审核';
            } else if (video.ued_status === '可用') {
                video.current_stage = 'UED审核通过';
            } else if (video.ued_status === '不可用') {
                video.current_stage = 'UED审核不通过';
            }
        }

        // 审核功能
        function openReviewModal(videoId, type) {
            const video = currentVideos.find(v => v.id === videoId);
            if (!video) return;

            currentReviewVideo = { ...video, type };
            
            const modal = new bootstrap.Modal(document.getElementById('reviewModal'));
            const videoElement = document.getElementById('reviewVideo');
            const reviewerElement = document.getElementById('reviewerName');
            
            // 设置视频源
            if (type === 'original') {
                videoElement.src = video.original_video_url;
            } else if (type === 'artwork') {
                videoElement.src = video.artwork_video_url;
            }
            
            // 设置审核员
            reviewerElement.value = video.annotation_reviewer || video.ued_reviewer || '未分配';
            
            modal.show();
        }

        function captureFrame() {
            console.log('截取当前帧');
            const screenshotsContainer = document.getElementById('screenshotsContainer');
            const screenshotDiv = document.createElement('div');
            screenshotDiv.className = 'mb-2 d-flex align-items-center';
            screenshotDiv.innerHTML = `
                <img src="https://via.placeholder.com/100x60/10b981/ffffff?text=截图" 
                     class="screenshot-thumbnail me-2" 
                     onclick="showScreenshot('screenshot')">
                <button class="btn btn-sm btn-outline-danger" onclick="removeScreenshot(this)">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            screenshotsContainer.appendChild(screenshotDiv);
        }

        function removeScreenshot(button) {
            button.parentElement.remove();
        }

        function submitReview() {
            if (!currentReviewVideo) {
                alert('请先选择要审核的视频');
                return;
            }

            const videoId = currentReviewVideo.id;
            const status = document.getElementById('reviewStatusSelect').value;
            const description = document.getElementById('problemDescription').value;
            
            console.log('提交审核结果:', { videoId, status, description });
            
            // 更新视频状态
            const video = currentVideos.find(v => v.id === videoId);
            if (video) {
                if (currentReviewVideo.type === 'original') {
                    video.annotation_status = status;
                    video.annotation_comment = description;
                } else if (currentReviewVideo.type === 'artwork') {
                    video.ued_status = status;
                    video.ued_comment = description;
                }
                updateCurrentStage(video);
            }
            
            // 重新渲染表格
            loadVideos();
            
            const modal = bootstrap.Modal.getInstance(document.getElementById('reviewModal'));
            modal.hide();
            
            alert('审核结果已提交');
        }

        // 上传功能
        function openUploadModal(videoId) {
            console.log(`打开上传模态框 - 视频ID: ${videoId}`);
            const modal = new bootstrap.Modal(document.getElementById('uploadModal'));
            modal.show();
        }

        function uploadVideo() {
            console.log('上传视频文件');
            const modal = bootstrap.Modal.getInstance(document.getElementById('uploadModal'));
            modal.hide();
            alert('视频上传成功');
        }

        // 生产详情
        function showProductionDetails(videoId) {
            console.log(`显示生产详情 - 视频ID: ${videoId}`);
            const modal = new bootstrap.Modal(document.getElementById('productionModal'));
            modal.show();
        }

        // 截图查看
        function showScreenshot(screenshotId) {
            console.log(`显示截图 - ID: ${screenshotId}`);
            const modal = new bootstrap.Modal(document.getElementById('screenshotModal'));
            modal.show();
        }

        // 列设置
        function showColumnSettings() {
            console.log('显示列设置');
            const modal = new bootstrap.Modal(document.getElementById('columnSettingsModal'));
            modal.show();
        }

        function selectAllColumns() {
            console.log('全选列');
        }

        function deselectAllColumns() {
            console.log('全不选列');
        }

        function resetToDefault() {
            console.log('恢复默认设置');
        }

        function saveColumnSettings() {
            console.log('保存列设置');
            const modal = bootstrap.Modal.getInstance(document.getElementById('columnSettingsModal'));
            modal.hide();
        }

        // 文件预览
        document.getElementById('videoFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const videoPreview = document.getElementById('videoPreview');
                const url = URL.createObjectURL(file);
                videoPreview.src = url;
                videoPreview.style.display = 'block';
            }
        });

        console.log('视频审核管理系统演示页面已加载');
    </script>
</body>
</html>